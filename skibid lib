
-- Aqua UI Library (Roblox LocalScript compatible) -- Fully syntax-validated, all 'end' mismatches fixed

local Aqua = {} Aqua.__index = Aqua

local UIS = game:GetService("UserInputService") local TweenService = game:GetService("TweenService") local Players = game:GetService("Players") local LP = Players.LocalPlayer

local function tween(obj,props,time) TweenService:Create(obj,TweenInfo.new(time or 0.15,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),props):Play() end

function Aqua:CreateWindow(cfg) local Window = {} local ScreenGui = Instance.new("ScreenGui") ScreenGui.Name = "AquaUI" ScreenGui.ResetOnSpawn = false ScreenGui.Parent = LP:WaitForChild("PlayerGui")

local Main = Instance.new("Frame")
Main.Size = UDim2.fromOffset(520,360)
Main.Position = UDim2.fromScale(0.3,0.3)
Main.BackgroundColor3 = Color3.fromRGB(20,30,35)
Main.BorderSizePixel = 0
Main.Parent = ScreenGui
Instance.new("UICorner",Main).CornerRadius = UDim.new(0,8)

local Top = Instance.new("Frame",Main)
Top.Size = UDim2.new(1,0,0,32)
Top.BackgroundColor3 = Color3.fromRGB(30,180,200)
Top.BorderSizePixel = 0

local Title = Instance.new("TextLabel",Top)
Title.Size = UDim2.new(1,0,1,0)
Title.BackgroundTransparency = 1
Title.Text = cfg.Name or "Aqua"
Title.TextColor3 = Color3.new(1,1,1)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 14

-- drag
local dragging=false
local dragStart, startPos

Top.InputBegan:Connect(function(i)
    if i.UserInputType==Enum.UserInputType.MouseButton1 or i.UserInputType==Enum.UserInputType.Touch then
        dragging=true
        dragStart=i.Position
        startPos=Main.Position
    end
end)

UIS.InputEnded:Connect(function(i)
    if i.UserInputType==Enum.UserInputType.MouseButton1 or i.UserInputType==Enum.UserInputType.Touch then
        dragging=false
    end
end)

UIS.InputChanged:Connect(function(i)
    if dragging and (i.UserInputType==Enum.UserInputType.MouseMovement or i.UserInputType==Enum.UserInputType.Touch) then
        local delta=i.Position-dragStart
        Main.Position=UDim2.new(startPos.X.Scale,startPos.X.Offset+delta.X,startPos.Y.Scale,startPos.Y.Offset+delta.Y)
    end
end)

-- tab panels
local TabList = Instance.new("Frame",Main)
TabList.Size = UDim2.new(0,120,1,-32)
TabList.Position = UDim2.fromOffset(0,32)
TabList.BackgroundColor3 = Color3.fromRGB(18,25,28)
TabList.BorderSizePixel = 0

local TabHolder = Instance.new("Frame",Main)
TabHolder.Size = UDim2.new(1,-120,1,-32)
TabHolder.Position = UDim2.fromOffset(120,32)
TabHolder.BackgroundTransparency = 1

local TabListLayout = Instance.new("UIListLayout",TabList)
TabListLayout.Padding = UDim.new(0,4)

-- resize
local Resize = Instance.new("Frame",Main)
Resize.Size = UDim2.fromOffset(16,16)
Resize.Position = UDim2.new(1,-16,1,-16)
Resize.BackgroundColor3 = Color3.fromRGB(30,180,200)
Resize.BorderSizePixel = 0

local resizing=false
local startSize,startMouse

Resize.InputBegan:Connect(function(i)
    if i.UserInputType==Enum.UserInputType.MouseButton1 or i.UserInputType==Enum.UserInputType.Touch then
        resizing=true
        startSize=Main.Size
        startMouse=i.Position
    end
end)

UIS.InputEnded:Connect(function(i)
    if i.UserInputType==Enum.UserInputType.MouseButton1 or i.UserInputType==Enum.UserInputType.Touch then
        resizing=false
    end
end)

UIS.InputChanged:Connect(function(i)
    if resizing and (i.UserInputType==Enum.UserInputType.MouseMovement or i.UserInputType==Enum.UserInputType.Touch) then
        local delta=i.Position-startMouse
        Main.Size=UDim2.fromOffset(startSize.X.Offset+delta.X,startSize.Y.Offset+delta.Y)
    end
end)

function Window:CreateTab(cfg)
    local Tab = {}

    local Button = Instance.new("TextButton",TabList)
    Button.Size = UDim2.new(1,-8,0,28)
    Button.Text = cfg.Name or "Tab"
    Button.BackgroundColor3 = Color3.fromRGB(30,180,200)
    Button.TextColor3 = Color3.new(1,1,1)
    Button.Font = Enum.Font.Gotham
    Button.TextSize = 13
    Button.BorderSizePixel = 0

    local Page = Instance.new("ScrollingFrame",TabHolder)
    Page.Size = UDim2.new(1,0,1,0)
    Page.CanvasSize = UDim2.new(0,0,0,0)
    Page.ScrollBarThickness = 4
    Page.Visible=false
    Page.BackgroundTransparency=1

    local PageLayout = Instance.new("UIListLayout",Page)
    PageLayout.Padding = UDim.new(0,6)

    Button.MouseButton1Click:Connect(function()
        for _,child in ipairs(TabHolder:GetChildren()) do
            if child:IsA("ScrollingFrame") then
                child.Visible=false
            end
        end
        Page.Visible=true
    end)

    function Tab:CreateSection(cfg)
        local Section = {}

        local Holder = Instance.new("Frame",Page)
        Holder.Size = UDim2.new(1,-8,0,30)
        Holder.BackgroundColor3 = Color3.fromRGB(25,35,40)
        Holder.BorderSizePixel=0

        local Title = Instance.new("TextLabel",Holder)
        Title.Size = UDim2.new(1,0,0,18)
        Title.BackgroundTransparency=1
        Title.Text = cfg.Name or "Section"
        Title.TextColor3 = Color3.new(1,1,1)
        Title.Font = Enum.Font.GothamBold
        Title.TextSize = 13

        local Content = Instance.new("Frame",Holder)
        Content.Position = UDim2.fromOffset(0,18)
        Content.Size = UDim2.new(1,0,0,0)
        Content.BackgroundTransparency=1

        local List = Instance.new("UIListLayout",Content)
        List.Padding = UDim.new(0,4)

        local function autoSize()
            Content.Size = UDim2.new(1,0,0,List.AbsoluteContentSize.Y)
            Holder.Size = UDim2.new(1,-8,0,18+List.AbsoluteContentSize.Y)
            Page.CanvasSize = UDim2.new(0,0,0,PageLayout.AbsoluteContentSize.Y)
        end
        List:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(autoSize)

        function Section:CreateButton(cfg)
            local B = Instance.new("TextButton",Content)
            B.Size = UDim2.new(1,0,0,24)
            B.Text = cfg.Name or "Button"
            B.BackgroundColor3 = Color3.fromRGB(30,180,200)
            B.TextColor3 = Color3.new(1,1,1)
            B.Font = Enum.Font.Gotham
            B.TextSize = 12
            B.BorderSizePixel=0

            B.MouseButton1Down:Connect(function() tween(B,{BackgroundColor3=Color3.fromRGB(20,140,160)},0.08) end)
            B.MouseButton1Up:Connect(function() tween(B,{BackgroundColor3=Color3.fromRGB(30,180,200)},0.08) end)
            B.MouseButton1Click:Connect(function()
                if cfg.Callback then cfg.Callback() end
            end)
        end

        function Section:CreateToggle(cfg)
            local state = cfg.Default or false
            local T = Instance.new("TextButton",Content)
            T.Size = UDim2.new(1,0,0,24)
            T.Text = cfg.Name or "Toggle"
            T.BackgroundColor3 = state and Color3.fromRGB(30,180,200) or Color3.fromRGB(50,60,65)
            T.TextColor3 = Color3.new(1,1,1)
            T.Font = Enum.Font.Gotham
            T.TextSize = 12
            T.BorderSizePixel=0

            local function set(v)
                state=v
                tween(T,{BackgroundColor3= state and Color3.fromRGB(30,180,200) or Color3.fromRGB(50,60,65)},0.12)
                if cfg.Callback then cfg.Callback(state) end
            end
            T.MouseButton1Click:Connect(function() set(not state) end)

            local API={}
            function API:Set(v) set(v) end
            return API
        end

        function Section:CreateSlider(cfg)
            local min,max = cfg.Min or 0, cfg.Max or 100
            local val = cfg.Default or min

            local Frame = Instance.new("Frame",Content)
            Frame.Size = UDim2.new(1,0,0,32)
            Frame.BackgroundTransparency=1

            local Label = Instance.new("TextLabel",Frame)
            Label.Size = UDim2.new(1,0,0,12)
            Label.BackgroundTransparency=1
            Label.Text = (cfg.Name or "Slider")..": "..val
            Label.TextColor3 = Color3.new(1,1,1)
            Label.Font = Enum.Font.Gotham
            Label.TextSize = 12

            local Bar = Instance.new("Frame",Frame)
            Bar.Position = UDim2.fromOffset(0,16)
            Bar.Size = UDim2.new(1,0,0,10)
            Bar.BackgroundColor3 = Color3.fromRGB(50,60,65)
            Bar.BorderSizePixel=0

            local Fill = Instance.new("Frame",Bar)
            Fill.Size = UDim2.new((val-min)/(max-min),0,1,0)
            Fill.BackgroundColor3 = Color3.fromRGB(30,180,200)
            Fill.BorderSizePixel=0

            local dragging=false
            Bar.InputBegan:Connect(function(i)
                if i.UserInputType==Enum.UserInputType.MouseButton1 or i.UserInputType==Enum.UserInputType.Touch then dragging=true end
            end)
            UIS.InputEnded:Connect(function(i)
                if i.UserInputType==Enum.UserInputType.MouseButton1 or i.UserInputType==Enum.UserInputType.Touch then dragging=false end
            end)
            UIS.InputChanged:Connect(function(i)
                if dragging then
                    local pct = math.clamp((i.Position.X-Bar.AbsolutePosition.X)/Bar.AbsoluteSize.X,0,1)
                    val = math.floor((min+(max-min)*pct)/(cfg.Increment or 1))*(cfg.Increment or 1)
                    Fill.Size = UDim2.new((val-min)/(max-min),0,1,0)
                    Label.Text = (cfg.Name or "Slider")..": "..val
                    if cfg.Callback then cfg.Callback(val) end
                end
            end)
        end

        function Section:CreateTextbox(cfg)
            local Box = Instance.new("TextBox",Content)
            Box.Size = UDim2.new(1,0,0,24)
            Box.Text = cfg.Default or ""
            Box.PlaceholderText = cfg.Name or "Textbox"
            Box.BackgroundColor3 = Color3.fromRGB(50,60,65)
            Box.TextColor3 = Color3.new(1,1,1)
            Box.Font = Enum.Font.Gotham
            Box.TextSize = 12
            Box.BorderSizePixel=0

            Box.FocusLost:Connect(function()
                if cfg.Callback then cfg.Callback(Box.Text) end
            end)
        end

        function Section:CreateDropdown(cfg)
            local open=false
            local current = cfg.Default or ""

            local HolderDD = Instance.new("Frame",Content)
            HolderDD.Size = UDim2.new(1,0,0,24)
            HolderDD.BackgroundTransparency=1

            local MainDD = Instance.new("TextButton",HolderDD)
            MainDD.Size = UDim2.new(1,0,1,0)
            MainDD.Text = (cfg.Name or "Dropdown")..": "..current
            MainDD.BackgroundColor3 = Color3.fromRGB(50,60,65)
            MainDD.TextColor3 = Color3.new(1,1,1)
            MainDD.Font = Enum.Font.Gotham
            MainDD.TextSize = 12
            MainDD.BorderSizePixel=0

            local ListFrame = Instance.new("Frame",HolderDD)
            ListFrame.Position = UDim2.fromOffset(0,24)
            ListFrame.Size = UDim2.new(1,0,0,0)
            ListFrame.BackgroundColor3 = Color3.fromRGB(40,50,55)
            ListFrame.BorderSizePixel=0
            ListFrame.ClipsDescendants=true

            local UIList = Instance.new("UIListLayout",ListFrame)

            local function rebuild()
                for _,c in ipairs(ListFrame:GetChildren()) do
                    if c:IsA("TextButton") then c:Destroy() end
                end
                for _,opt in ipairs(cfg.Options or {}) do
                    local B = Instance.new("TextButton",ListFrame)
                    B.Size = UDim2.new(1,0,0,22)
                    B.Text = opt
                    B.BackgroundColor3 = Color3.fromRGB(60,70,75)
                    B.TextColor3 = Color3.new(1,1,1)
                    B.Font = Enum.Font.Gotham
                    B.TextSize = 12
                    B.BorderSizePixel=0
                    B.MouseButton1Click:Connect(function()
                        current=opt
                        MainDD.Text=(cfg.Name or "Dropdown")..": "..current
                        open=false
                        ListFrame.Size=UDim2.new(1,0,0,0)
                        if cfg.Callback then cfg.Callback(current) end
                    end)
                end
            end
            rebuild()

            MainDD.MouseButton1Click:Connect(function()
                open=not open
                ListFrame.Size = open and UDim2.new(1,0,0,#(cfg.Options or {})*22) or UDim2.new(1,0,0,0)
            end)
        end

        function Section:CreateLabel(text)
            local L = Instance.new("TextLabel",Content)
            L.Size = UDim2.new(1,0,0,20)
            L.Text = text or "Label"
            L.BackgroundTransparency=1
            L.TextColor3 = Color3.new(1,1,1)
            L.Font = Enum.Font.Gotham
            L.TextSize = 12
        end

        function Section:CreateBind(cfg)
            local mode = cfg.Mode or "Key"
            local key = cfg.Default or Enum.KeyCode.E
            local waiting=false

            local B = Instance.new("TextButton",Content)
            B.Size = UDim2.new(1,0,0,24)
            B.Text = (cfg.Name or "Bind")..": "..(mode=="Key" and key.Name or "Button")
            B.BackgroundColor3 = Color3.fromRGB(50,60,65)
            B.TextColor3 = Color3.new(1,1,1)
            B.Font = Enum.Font.Gotham
            B.TextSize = 12
            B.BorderSizePixel=0

            B.MouseButton1Click:Connect(function()
                if mode=="Button" then
                    if cfg.Callback then cfg.Callback() end
                else
                    waiting=true
                    B.Text = (cfg.Name or "Bind")..": ..."
                end
            end)

            UIS.InputBegan:Connect(function(i,gp)
                if gp then return end
                if waiting and i.KeyCode~=Enum.KeyCode.Unknown then
                    key=i.KeyCode
                    waiting=false
                    B.Text = (cfg.Name or "Bind")..": "..key.Name
                elseif mode=="Key" and i.KeyCode==key then
                    if cfg.Callback then cfg.Callback() end
                end
            end)
        end

        return Section
    end

    return Tab
end

return Window

end

return Aqua
